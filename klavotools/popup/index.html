<html>
<head>
    <title>KlavoTools - Popup</title>
    <link href="style.css" type="text/css" rel="stylesheet" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script src="../../kango-ui/kango_api.js"></script>
    <script src="../angular.min.js"></script>
    <script src="popup.js"></script>
    <script src="popup.menutree.js"></script>
    <script src="popup.redirect.js"></script>
    <script src="popup.fl-editor.js"></script>
</head>
<body style="height:130px;width: 520px;">
    <div id="cssmenu" ui:css:menu>
        Menu loading...
    </div>
    <!-- Search user form -->
    <form
        class="userline"
        ng:controller="popup:SearchUser as SearchUser"
        ng:submit="SearchUser.search()">
        
        <img ng:if="SearchUser.loading" src="http://klavogonki.ru/img/small_loading.gif" />
        <img ng:if="SearchUser.id!==0" src="http://klavogonki.ru/img/ok.gif" />
        
        <input
            type="text"
            tabindex="1"
            ng:model="SearchUser.login" />
            
        <input
            type="button"
            value="→"
            tabindex="2"
            ng:click="SearchUser.search()" />
        
        <span ng:if="SearchUser.id===false">не найден</span>
        <span ng:if="SearchUser.id!=0" class="get-id-links">
            ID: {{SearchUser.id}} |
            <a title="Профиль">
                <img ng:path ng:path:str="/u/#/{{SearchUser.id}}/" src="../../icons/profile.png" />
            </a>
            <a title="Статистика">
                <img ng:path ng:path:str="/u/#/{{SearchUser.id}}/stats/" src="../../icons/sprint.png" />
            </a>
            <a title="Бортжурнал">
                <img ng:path ng:path:str="/u/#/{{SearchUser.id}}/journal/" src="../../icons/usefuladdons.png" />
            </a>
            <!--
                TODO: add links to achievements and friends.         
            -->
        </span>
    </form>
    
    <!-- Fast links editor -->
    <div class="editor" ng:controller="popup:FastLinks as FastLinks" ng:show="FastLinks.visible">
        <textarea ng:model="FastLinks.txtlinks"></textarea>
        <div class="note">* <b>"__USERID__"</b> будет заменяться на ID активного аккаунта</div>
        <table>
            <tr>
                <td>Текст:</td>
                <td class="td-center">
                    <input tabindex='3' type="text" ng:model="FastLinks.title" />
                </td>
                <td class="td-right">
                    <input tabindex='5' type="button" value="Добавить" ng:click="FastLinks.add()" />
                </td>
            </tr>
            <tr>
                <td>Ссылка:</td>
                <td class="td-center">
                    <input tabindex='4' type="text" ng:model="FastLinks.url" />
                </td>
                <td class="td-right">
                    <input tabindex='6' type="button" value="Сохранить" ng:click="FastLinks.save()" />
                </td>
            </tr>
        </table>
    </div>
    
    <script type="text/ng-template" id="uiCssMenu_Template">
        <ul>
            <li ng:repeat="m in menu" ng:class="{'has-sub': m.sub}" ng:hide="m.hidden">
                <a ng:style="{color: m.color}" ng:path="m.path">{{m.title}}</a>
                <ul>
                    <li ng:repeat="sub in m.sub">
                        <a ng:path="sub.path">{{sub.title}}</a>
                    </li>
                </ul>
            </li>
            <li class="has-sub">
                <a>Ссылки</a>
                <ul>
                    <li>
                        <a ng:click="openEditor()"><i>{{links.length ? "Изменить" : "Добавить"}}</i></a>
                    </li>
                    <li ng:repeat="fl in links">
                        <a ng:path="fl.url">{{fl.title}}</a>
                    </li>
                </ul>
            </li>
            <li>
                <a style="color:green;" ng:path ng:path:str="__EXTENSION_OPTIONS__">Настройки</a>
            </li>
        </ul>
    </script>
</body>
</html>